name: polyreg

task:
  _target_: tasks.polynomial_regression.PolynomialRegressionICL
  lr: 1e-4
  order: ${..data.order}
  model:
    _target_: models.explicit.ExplicitModelWith
    context_model:
      _target_: models.explicit.TransformerContext
      x_dim: 1
      y_dim: 1
      n_features: 128
      n_heads: 2
      n_hidden: 256
      n_layers: 4
    prediction_model:
      _target_: models.explicit.TransformerPrediction
      x_dim: 1
      y_dim: 1
      z_dim: ${.n_features}
      n_features: 128
      n_heads: 2
      n_hidden: 256
      n_layers: 4

data:
  _target_: data.polynomial_regression.PolynomialRegressionDataModule
  order: 4
  min_context: 12
  max_context: 30
  batch_size: 128
  train_size: 1280
  val_size: 128
  noise: 0.0
  ood: True

trainer:
  max_epochs: 1000

callbacks:
  - _target_: lightning.pytorch.callbacks.EarlyStopping
    monitor: "val/MSE"
    patience: 100
    mode: min