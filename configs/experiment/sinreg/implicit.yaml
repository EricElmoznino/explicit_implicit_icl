name: sinreg

task:
  _target_: tasks.regression.RegressionICL
  lr: 1e-4
  param_dim: 3
  model:
    _target_: models.implicit.TransformerImplicit
    x_dim: 1
    y_dim: 1
    n_features: 128
    n_heads: 2
    n_hidden: 256
    n_layers: 4

data:
  _target_: data.regression.RegressionDataModule
  kind: sinusoidal
  kind_kwargs:
    freqs: [2, 4, 8]
    max_amplitudes: [1, 0.5, 0.25]
  min_context: 12
  max_context: 30
  batch_size: 128
  train_size: 1280
  val_size: 128
  noise: 0.0
  ood_train: False
  ood_val: True

trainer:
  max_epochs: 1000

callbacks:
  - _target_: lightning.pytorch.callbacks.EarlyStopping
    monitor: "train/MSE"
    patience: 100
    mode: min